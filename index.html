<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CarePulse247 | Real-Time RPM App</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <a href="#main" class="skip-link">Skip to main content</a>

  <!-- HEADER (NO NAV BAR) -->
  <header class="site-header">
    <div class="header-inner">
      <div class="logo">
        <span class="logo-pill">RCC</span>
        <div>
          <h1>Remote Care Connect</h1>
          <p class="subtitle">Real-time remote patient monitoring web application</p>
        </div>
      </div>
    </div>
  </header>

  <main id="main" class="container">
    <!-- AUTH CARD (LOGIN + SIGNUP) -->
    <section id="auth-section" class="card auth-card">
      <h2 class="center-heading">Sign in to continue</h2>
      <p class="muted tiny center-text">
        Secure access for patients, doctors, and admins. No billing features are included.
      </p>

      <!-- SECURITY NOTES -->
      <div class="inner-card slim-card security-card">
        <h4>Security notes (demo)</h4>
        <ul class="muted tiny">
          <li>• This prototype uses only browser storage (<code>localStorage</code>) – no real PHI is stored.</li>
          <li>• In a production system, all data would be encrypted, stored on secure servers, and protected with HIPAA-aligned controls.</li>
          <li>• Features such as session timeout, basic lockout, and role-based access are included for demonstration.</li>
        </ul>
      </div>

      <div class="auth-toggle">
        <button id="mode-login" class="auth-toggle-btn active" type="button">
          Login
        </button>
        <button id="mode-signup" class="auth-toggle-btn" type="button">
          Sign up
        </button>
      </div>

      <!-- LOGIN FORM -->
      <form id="login-form" class="form-grid">
        <h3>Login</h3>
        <p class="muted">
          Choose your role and enter your credentials to access your live RPM workspace.
        </p>

        <label for="role-select">Role</label>
        <select id="role-select" required>
          <option value="">Select role</option>
          <option value="admin">Admin</option>
          <option value="doctor">Doctor</option>
          <option value="patient">Patient</option>
        </select>

        <!-- Admin-only fields -->
        <label for="admin-email" class="admin-field hidden">Admin email</label>
        <input
          type="email"
          id="admin-email"
          class="admin-field hidden"
          placeholder="admin@rcc.com"
          autocomplete="off"
        />

        <label for="admin-password" class="admin-field hidden">Admin password</label>
        <input
          type="password"
          id="admin-password"
          class="admin-field hidden"
          placeholder="••••••••"
          autocomplete="off"
        />

        <!-- Doctor / Patient ID -->
        <label for="id-input" id="id-label">ID</label>
        <input
          type="text"
          id="id-input"
          placeholder="e.g., D001 or P001"
          autocomplete="off"
        />

        <!-- Doctor / Patient password -->
        <label for="user-password" id="user-password-label" class="user-password-field">
          Password
        </label>
        <input
          type="password"
          id="user-password"
          class="user-password-field"
          placeholder="Enter your password"
          autocomplete="off"
        />

        <p class="muted tiny">
          Default password (if you haven&rsquo;t signed up yet): <code>ID@123</code>.
          Examples: <code>D001@123</code>, <code>P001@123</code>.
        </p>

        <button type="submit" class="btn-primary">Login</button>
        <p id="login-error" class="error-text"></p>

        <div class="auth-links">
          <button type="button" id="forgot-password-btn" class="link-btn">
            Forgot password?
          </button>
          <button type="button" id="show-change-password-btn" class="link-btn">
            Change password
          </button>
        </div>
      </form>

      <!-- SIGNUP FORM -->
      <form id="signup-form" class="form-grid hidden">
        <h3>Create account</h3>
        <p class="muted">
          Sign up as a doctor or patient using an existing ID from the RPM dataset.
        </p>

        <label for="signup-role">Role</label>
        <select id="signup-role" required>
          <option value="">Select role</option>
          <option value="doctor">Doctor</option>
          <option value="patient">Patient</option>
        </select>

        <label for="signup-id">ID</label>
        <input
          type="text"
          id="signup-id"
          placeholder="e.g., D001 or P001"
          autocomplete="off"
          required
        />

        <label for="signup-name">Name</label>
        <input
          type="text"
          id="signup-name"
          placeholder="Your full name (optional)"
          autocomplete="off"
        />

        <label for="signup-password">Password</label>
        <input
          type="password"
          id="signup-password"
          placeholder="Choose a password (min 6 characters)"
          autocomplete="off"
          required
        />

        <label for="signup-password-confirm">Confirm password</label>
        <input
          type="password"
          id="signup-password-confirm"
          placeholder="Re-enter password"
          autocomplete="off"
          required
        />

        <p class="muted tiny">
          Passwords are stored locally in this browser using <code>localStorage</code>
          for demo purposes (not real PHI storage).
        </p>

        <button type="submit" class="btn-primary">Create account</button>
        <p id="signup-error" class="error-text"></p>
        <p id="signup-success" class="success-text"></p>
      </form>

      <!-- CHANGE PASSWORD (UNDER LOGIN) -->
      <section id="change-password-section" class="inner-card hidden">
        <h3>Change password</h3>
        <form id="change-password-form" class="form-grid">
          <label for="cp-role">Role</label>
          <select id="cp-role" required>
            <option value="">Select role</option>
            <option value="doctor">Doctor</option>
            <option value="patient">Patient</option>
          </select>

          <label for="cp-id">ID</label>
          <input
            type="text"
            id="cp-id"
            placeholder="e.g., D001 or P001"
            required
          />

          <label for="cp-current">Current password</label>
          <input type="password" id="cp-current" required />

          <label for="cp-new">New password</label>
          <input type="password" id="cp-new" required />

          <label for="cp-confirm">Confirm new password</label>
          <input type="password" id="cp-confirm" required />

          <button type="submit" class="btn-primary">Update password</button>
          <p id="cp-error" class="error-text"></p>
          <p id="cp-success" class="success-text"></p>
        </form>
      </section>
    </section>

    <!-- DASHBOARDS (SHOWN AFTER LOGIN) -->
    <section id="dashboard-section" class="hidden">
      <div class="dashboard-header">
        <div>
          <h2 id="dashboard-title">Dashboard</h2>
          <p id="dashboard-subtitle" class="muted tiny">
            Real-time style prototype using RPM events, patients, and doctors — no billing features.
          </p>
        </div>
        <button id="logout-btn" class="btn-secondary">Logout</button>
      </div>

      <!-- ADMIN DASHBOARD -->
      <section id="admin-dashboard" class="dashboard-panel hidden">
        <div class="panel-header">
          <div>
            <h3>Admin overview</h3>
            <p id="admin-last-login" class="muted tiny"></p>
          </div>
          <span class="role-badge admin">Admin</span>
        </div>

        <div class="kpi-grid">
          <div class="kpi-card">
            <h4>Total patients</h4>
            <p id="kpi-total-patients" class="kpi-value">–</p>
          </div>
          <div class="kpi-card">
            <h4>Total doctors</h4>
            <p id="kpi-total-doctors" class="kpi-value">–</p>
          </div>
          <div class="kpi-card">
            <h4>Total RPM events</h4>
            <p id="kpi-total-events" class="kpi-value">–</p>
          </div>
          <div class="kpi-card">
            <h4>Avg response time (min)</h4>
            <p id="kpi-avg-response" class="kpi-value">–</p>
          </div>
        </div>

        <div class="panel-layout">
          <div class="panel-column">
            <h4>Program snapshot</h4>
            <p class="muted tiny">
              Admins see volume, coverage, and responsiveness across the RPM program.
            </p>
            <ul class="muted tiny">
              <li>• Enrollment by patient and doctor counts.</li>
              <li>• Total alert volume and monitoring intensity.</li>
              <li>• Response-time patterns across severity levels.</li>
            </ul>

            <h4 style="margin-top: 1.2rem;">Global notifications & alerts</h4>
            <div class="table-wrapper small-table">
              <table>
                <thead>
                  <tr>
                    <th>Time</th>
                    <th>Role</th>
                    <th>Message</th>
                    <th>Level</th>
                  </tr>
                </thead>
                <tbody id="admin-notifications-table"></tbody>
              </table>
            </div>

            <h4 style="margin-top: 1.2rem;">Security and audit notes</h4>
            <p class="muted tiny">
              This prototype demonstrates role-based access, session timeout, and basic lockout for repeated failed logins.
              A full production system would integrate centralized identity, audit logging, and encryption in transit and at rest.
            </p>
          </div>

          <div class="panel-column">
            <h4>Power BI RPM dashboard</h4>
            <div class="embed-wrapper">
              <iframe
                title="RPM Power BI Report"
                src="https://app.powerbi.com/view?r=eyJrIjoiNThmOGEzMWMtMDI1Yi00OTQ1LTgzOTctZjQxNzJjMTU5ZDRjIiwidCI6ImNiMGNiZDgzLTU4ZGQtNDVhNS1hYWViLTc5Y2M0NDBmYjAzOCIsImMiOjF9"
                frameborder="0"
                allowfullscreen="true"
              ></iframe>
            </div>

            <h4 style="margin-top: 1.2rem;">Meeting audit log</h4>
            <div class="table-wrapper small-table">
              <table>
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Doctor</th>
                    <th>Patient</th>
                    <th>Time</th>
                    <th>Type</th>
                    <th>Status</th>
                    <th>Created by</th>
                  </tr>
                </thead>
                <tbody id="admin-meetings-table"></tbody>
              </table>
            </div>
          </div>
        </div>
      </section>

      <!-- DOCTOR DASHBOARD -->
      <section id="doctor-dashboard" class="dashboard-panel hidden">
        <div class="panel-header">
          <div>
            <h3>Doctor console</h3>
            <p id="doctor-last-login" class="muted tiny"></p>
          </div>
          <span class="role-badge doctor">Doctor</span>
        </div>

        <div id="doctor-info" class="info-card"></div>

        <!-- FIRST: MEETINGS + NOTIFICATIONS -->
        <div class="panel-layout" style="margin-top: 1.2rem;">
          <div class="panel-column">
            <h4>Meetings with patients</h4>
            <p class="muted tiny">
              Virtual visits linking you with your assigned patients. Use Zoom to connect.
            </p>
            <div class="table-wrapper small-table">
              <table>
                <thead>
                  <tr>
                    <th>Time</th>
                    <th>Patient</th>
                    <th>Type</th>
                    <th>Status</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody id="doctor-meetings-table"></tbody>
              </table>
            </div>

            <!-- CREATE MEETING SECTION -->
            <div class="inner-card slim-card">
              <h4>Schedule new meeting</h4>
              <form id="create-meeting-form" class="form-grid small-form">
                <label for="create-meeting-patient">Patient</label>
                <select id="create-meeting-patient" required>
                  <option value="">Select assigned patient</option>
                </select>

                <label for="create-meeting-datetime">Date &amp; time</label>
                <input
                  type="datetime-local"
                  id="create-meeting-datetime"
                  required
                />

                <label for="create-meeting-type">Meeting type</label>
                <select id="create-meeting-type" required>
                  <option value="Virtual check-in">Virtual check-in</option>
                  <option value="Follow-up">Follow-up</option>
                  <option value="Initial consult">Initial consult</option>
                  <option value="Medication review">Medication review</option>
                </select>

                <button type="submit" class="btn-primary">Create meeting</button>
              </form>
              <p id="create-meeting-msg" class="success-text"></p>
            </div>
          </div>

          <div class="panel-column">
            <h4>Notifications & alerts</h4>
            <p class="muted tiny">
              Real-time style alerts summarizing high-severity events and reminders.
            </p>
            <ul id="doctor-notifications-list" class="notification-list"></ul>
          </div>
        </div>

        <!-- DETAILS TOGGLE -->
        <div class="details-toggle">
          <button id="doctor-details-btn" class="btn-secondary">
            View patient details &amp; RPM events
          </button>
        </div>

        <!-- DETAILS SECTION: PATIENT TABLE + RPM EVENTS WITH FILTER / LOAD MORE -->
        <section id="doctor-details-section" class="inner-card hidden">
          <h4>Assigned patients</h4>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>Patient ID</th>
                  <th>Name</th>
                  <th>Age</th>
                  <th>Gender</th>
                  <th>Condition</th>
                  <th>Device</th>
                  <th>City</th>
                </tr>
              </thead>
              <tbody id="doctor-patient-table"></tbody>
            </table>
          </div>

          <div class="events-header">
            <h4>RPM events</h4>
            <div class="events-controls">
              <label for="doctor-events-patient-filter" class="tiny">Patient</label>
              <select id="doctor-events-patient-filter">
                <option value="all">All patients</option>
              </select>
              <label for="doctor-events-filter" class="tiny">Time</label>
              <select id="doctor-events-filter">
                <option value="all">All time</option>
                <option value="24h">Last 24 hours</option>
                <option value="7d">Last 7 days</option>
                <option value="30d">Last 30 days</option>
              </select>
              <button
                id="doctor-events-more"
                type="button"
                class="btn-secondary small"
              >
                Load more
              </button>
            </div>
          </div>

          <p id="doctor-events-summary" class="events-summary tiny muted"></p>

          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Event ID</th>
                  <th>Patient ID</th>
                  <th>Severity</th>
                  <th>Resp. (min)</th>
                  <th>Heart rate</th>
                  <th>BP (sys/dia)</th>
                </tr>
              </thead>
              <tbody id="doctor-events-table"></tbody>
            </table>
          </div>
        </section>
      </section>

      <!-- PATIENT DASHBOARD -->
      <section id="patient-dashboard" class="dashboard-panel hidden">
        <div class="panel-header">
          <div>
            <h3>Patient view</h3>
            <p id="patient-last-login" class="muted tiny"></p>
          </div>
          <span class="role-badge patient">Patient</span>
        </div>

        <div id="patient-info" class="info-card"></div>

        <!-- FIRST: MEETINGS + NOTIFICATIONS -->
        <div class="panel-layout" style="margin-top: 1.2rem;">
          <div class="panel-column">
            <h4>Your meetings with your doctor</h4>
            <p class="muted tiny">
              Scheduled telehealth visits and follow-ups with your treating doctor.
            </p>
            <div class="table-wrapper small-table">
              <table>
                <thead>
                  <tr>
                    <th>Time</th>
                    <th>Doctor</th>
                    <th>Type</th>
                    <th>Status</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody id="patient-meetings-table"></tbody>
              </table>
            </div>

            <!-- CREATE MEETING (Patient) -->
            <div class="inner-card slim-card">
              <h4>Schedule a meeting with your doctor</h4>
              <form id="patient-create-meeting-form" class="form-grid small-form">
                <label for="patient-meeting-datetime">Date &amp; time</label>
                <input
                  type="datetime-local"
                  id="patient-meeting-datetime"
                  required
                />

                <label for="patient-meeting-type">Meeting type</label>
                <select id="patient-meeting-type" required>
                  <option value="Virtual check-in">Virtual check-in</option>
                  <option value="Follow-up">Follow-up</option>
                  <option value="Initial consult">Initial consult</option>
                  <option value="Medication review">Medication review</option>
                </select>

                <button type="submit" class="btn-primary">Request meeting</button>
              </form>
              <p id="patient-create-meeting-msg" class="success-text"></p>
            </div>
          </div>

          <div class="panel-column">
            <h4>Notifications & health alerts</h4>
            <p class="muted tiny">
              Alerts about high readings, instructions, or upcoming appointments.
            </p>
            <ul id="patient-notifications-list" class="notification-list"></ul>
          </div>
        </div>

        <!-- DETAILS TOGGLE -->
        <div class="details-toggle">
          <button id="patient-details-btn" class="btn-secondary">
            View RPM details
          </button>
        </div>

        <!-- PATIENT DETAILS SECTION WITH FILTER / LOAD MORE -->
        <section id="patient-details-section" class="inner-card hidden">
          <div class="events-header">
            <h4>Your RPM events</h4>
            <div class="events-controls">
              <label for="patient-events-filter" class="tiny">Time</label>
              <select id="patient-events-filter">
                <option value="all">All time</option>
                <option value="24h">Last 24 hours</option>
                <option value="7d">Last 7 days</option>
                <option value="30d">Last 30 days</option>
              </select>
              <button
                id="patient-events-more"
                type="button"
                class="btn-secondary small"
              >
                Load more
              </button>
            </div>
          </div>

          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Event ID</th>
                  <th>Severity</th>
                  <th>Resp. (min)</th>
                  <th>Heart rate</th>
                  <th>BP (sys/dia)</th>
                  <th>Device uptime (min)</th>
                </tr>
              </thead>
              <tbody id="patient-events-table"></tbody>
            </table>
          </div>
        </section>
      </section>
    </section>
  </main>

  <footer class="site-footer">
    <p>Remote Care Connect · Real-time RPM Web Application Prototype</p>
  </footer>

  <!-- CSV parser -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="app.js"></script>
</body>
</html>

